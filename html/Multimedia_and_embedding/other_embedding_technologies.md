# object から iframe へ、その他の埋め込み技術

> 参考：[objectからiframeへ、その他の埋め込み技術](https://developer.mozilla.org/ja/docs/Learn/HTML/Multimedia_and_embedding)
>
> Webページにさまざまな種類のコンテンツを埋め込むことができる要素、`<iframe>, <embed>, <object>`を紹介します。
>
> その他に、PDF, SVG, さらにFlashなどの紹介します。

## 埋め込みの短い歴史

**フレーム、フレームセット**

- 昔のウェブでは、**フレーム**をつかってウェブサイトを作るのが一般的だった。これはウェブサイトの小さな部分が個々のHTMLページに保存する方法でした。

- これは**フレームセット**と呼ばれるマスター文書に埋め込まれていました。これにより、テーブルの列と行のサイジングのように、各フレームが埋めた画面上の領域を指定することができた。

- この手法はダウンロード速度が向上する利点があったが、時代が進むにつれネットワーク速度が早くなっていき使用されなくなりました。

**Javaアプレット、Flash**

- 90年代後半、2000年代初頭でJavaアプレットやFlashなどのプラグイン技術が普及しました。これにより、ウェブ開発者は動画やアニメーションなどのWebページに豊富なコンテンツを埋め込むことが可能になりました。
- これは`object`や`embed`要素で実現され、当時は非常に便利だった。
- しかし、アクセシビリティ、セキュリティ、ファイルサイズなどの多くの問題が発生して以来、廃れていきました。Flashもすでにサポートを終了しています。

**iframe要素**

- canvasやvideo要素と一緒に`iframe`要素が現れました。これはウェブ文書全体を別のウェブ文書に埋め込む方法を提供し、あたかも`img`要素か他の要素であるかのように振る舞います。

## アクティブラーニング：従来の埋め込みを使う

これはyoutubeやgoogleマップのウェブサイトへ訪れて、「埋め込む」のところへいくとコードが表示され、それをコピーアンドペーストすると実現できる。

## iframeの詳細

iframe要素は他のウェブ文書を現在の文書に埋め込むことができるように設計されています。

これは直接制御できない可能性のある第三者のコンテンツをWebサイトに組み込むのに適しており、どこじのバージョンを実装する必要がありません

例として、オンライン動画プロバイダの動画や[Disqus](https://disqus.com/)のようなコメントシステム、オンライン地図プロバイダの地図、広告バナーなどが挙げられます。

**iframeのオプション**

- allowfullscreen
  - Full Screen APIを使用してフルスクリーンモードにすることができる。

- frameborder
  - 1に設定すると境界を描画します。しかしCSSでやった方が良い。
- src
  - 埋め込みたいURLを指定します。
- widthとheight
  - 幅と高さを指定します。
- 代替コンテンツ
  - ブラウザがiframeをサポートしていない場合に表示されるコンテンツのこと。
- sandbox
  - iframeの機能よりも若干現代的なブラウザ（例えばIE10以上）で機能し、高度なセキュリティ設定を要求します。

## セキュリティ上の懸念

ブラウザーメーカーやウェブ開発者は、iframe がウェブ上の悪意ある人物(しばしば**ハッカー**、またはより正確には**クラッカー**と呼ばれます)の共通のターゲット(公式の用語: **攻撃ベクター**)であるということを苦労して学びました。

悪意ある人物は、あなたのウェブページを悪意を持って改ざんすることや、ユーザ名やパスワードなどの機密情報を明らかにするなど、人を騙し望んでいないことを行います。

このため、仕様技術者とブラウザー開発者は、`<iframe>` をより安全にするためのさまざまなセキュリティ・メカニズムを開発しました。

> [クリックジャッキング](https://ja.wikipedia.org/wiki/クリックジャッキング)は、ハッカーが目に見えない iframe をあなたの文書に埋め込んだり(あなたの文書を自分の悪意のあるウェブサイトに埋め込んだり)して、ユーザの操作を乗っ取るための一般的な iframe 攻撃の一種です。これは、ユーザを誤解させたり機密データを盗む一般的な方法です。

簡単な例ですが、適当なウェブサイトのURLをブラウザで読み込むとしましょう。するとこのようなエラーが表示されます。

```log
Load denied by X-Frame-Options: https://developer.mozilla.org/en-US/docs/Glossary does not permit framing." (X-Frame-Optionsによって読み込みが拒否されました: https://developer.mozilla.org/en-US/docs/Glossary はフレーミングを許可していません。
```

これはウェブサイトを作成した開発者が、iframe内に埋め込まれないようにウェブサイトのページを提供する設定をサーバーに組み込んだためです。

もしも埋め込まれるような設定をしてしまった場合、Webページが無駄に読み込まれたり、クリックジャッキングを介してデータを盗み出そうとしたりします。

これらは帯域幅の追加で多額の費用が発生したり、セキュリティにも懸念が出たりします。

### 必要な時にのみ埋め込みます

完全に必要な時、第三者のコンテンツだけを埋め込むのであれば、悩むことはありません。

ウェブセキュリティの良い経験則として「慎重すぎることが決してありません。もしあなたがそれを作ったら、とにかくそれをもう一度チェックしてください。他の誰かがそれを作ったら、そうでないと証明されるまでそれは危険です。」がある。

セキュリティの他に、知的財産の問題にも注意する必要があります。ほとんどのコンテンツは著作権で保護されており、オフラインでもオンラインでも、予期していないコンテンツでさえもあります。

所有している、または所有者があなたに書面による明白な許可を与えていない限り、Webページにコンテンツを表示しないでください。しかし慎重すぎることはありません。

コンテンツにライセンスが付与されている場合は、ライセンス条項に従わなければなりません。例えばMDNのコンテンツは、CC-BY-SAで[ライセンス](https://developer.mozilla.org/ja/docs/MDN/About#copyrights_and_licenses)されています。つまり、コンテンツを大幅に変更した場合でも、コンテンツを引用する際には、[適切にクレジットを表示する](https://wiki.creativecommons.org/wiki/Best_practices_for_attribution)必要があります

### HTTPSを使用する

HTTPSはHTTPの暗号化されたバージョンです。可能であれば、HTTPSを使用してWebサイトを提供する必要があります。

**理由**

- 転送中にリモートコンテンツが改竄される可能性が減る。
- 埋め込みコンテンツが親文書内のコンテンツにアクセスすることを防止する。逆も同様です。

HTTPSを使用するには、高価なセキュリティ証明書が必要です（ただし[Let's Encrypt](https://letsencrypt.org/)で簡単に入手できます）。

重要な事項として、第三者のコンテンツをHTTPに埋め込むことは絶対にしないでください（最良の場合のシナリオでは、ユーザのウェブブラウザが恐ろしい警告を表示します）

### 常にsandbox属性を使用する

適切に使用できるが、コードベースの残りの部分に何らかの（偶発的または悪意のある）害を及ぼすことができないコード用のコンテナを[サンドボックス](https://ja.wikipedia.org/wiki/サンドボックス_(セキュリティ))といいます。

サンドボックスにないコンテンツは、JavaScriptの実行、フォームの送信、ポップアップウィンドウなど多くのことを行うことができます。

またiframeに一部の権限だけ与えたい場合はsandbox属性に値を付与させる。値については[sandboxのreference](https://developer.mozilla.org/ja/docs/Web/HTML/Element/iframe#attr-sandbox)を参照してください。

### CSPディレクティブの設定

CSPはコンテンツセキュリティポリシーの略で、HTML文書のセキュリティを強化するために設計された一連のHTTPヘッダ（ウェブサーバーから配信された時にWebページと共に送信されるメタデータ）を提供します。

iframe要素を保護する場合、適切なX-Frame-Optionsヘッダを送信するようにサーバーを構成できます。これにより他のウェブサイトがそのWebページにあなたのコンテンツを埋め込むのを防ぐことができます。

## embed要素とobject要素

JavaアプレットやFlashなどのプラグイン技術、PDF、動画、SVG、画像などのコンテンツを含む、複数のタイプの外部コンテンツを埋め込む汎用埋め込みツールです！

しかし、現在ではほとんど使われておらず、イントラネットやエンタープライズプロジェクトのような特定の状況でそれらは見つかるかもしれません。

ほとんど使わない技術なのでここでは書きません！[embed要素とobject要素](https://developer.mozilla.org/ja/docs/Learn/HTML/Multimedia_and_embedding/Other_embedding_technologies#the_embed_and_object_elements)へどうぞ...