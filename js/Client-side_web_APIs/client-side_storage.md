# ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸

> å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Learn/JavaScript/Client-side_web_APIs/Client-side_storage

ã“ã®ãƒšãƒ¼ã‚¸ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ä¸Šã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹æ©Ÿèƒ½ãŒã©ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã®ã‹ã¨ã„ã†åŸºæœ¬çš„ãªç‚¹ã«ã¤ã„ã¦ã¿ã¦ã„ãã¾ã™ã€‚

ãƒ¢ãƒ€ãƒ³ã‚¦ã‚§ãƒ–ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ã®è¨±å¯ã§ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¦ãƒ¼ã‚¶ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ä¸Šã«ä¿å­˜ã™ã‚‹æ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®æ©Ÿèƒ½ã«ã‚ˆã‚Šã€é•·æœŸé–“è¨˜æ†¶ã®ãŸã‚ã«ãƒ‡ãƒ¼ã‚¿ã‚’å­˜ç¶šã•ã›ã‚‹ã“ã¨ã‚„ã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³åˆ©ç”¨ã®ãŸã‚ã«ã‚µã‚¤ãƒˆã‚„æ–‡æ›¸ã®ä¿å­˜ã€ãƒ¦ãƒ¼ã‚¶ç‹¬è‡ªã®è¨­å®šã‚’ä¿æŒã™ã‚‹ã“ã¨ãªã©ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã®ä¿å­˜ã¨ã¯

ç¾åœ¨ã®ä¸»è¦ãªãƒ¢ãƒ€ãƒ³ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã¯å‹•çš„ã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ã‚µãƒ¼ãƒãƒ¼ä¸Šã«è¨˜æ†¶ã—ã€å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã‚µãƒ¼ãƒãƒ¼å´ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã€ãã®ãƒ‡ãƒ¼ã‚¿ã‚’é™çš„ãªãƒšãƒ¼ã‚¸é››å½¢ã«æŒ¿å…¥ã—ã€å‡ºæ¥ä¸ŠãŒã£ãŸHTMLã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«æä¾›ã—ã€ãƒ¦ãƒ¼ã‚¶ã®ãƒ–ãƒ©ã‚¦ã‚¶ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã®ä¿å­˜ã¯ä¼¼ãŸã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã€‚ãã—ã¦ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä¸Šã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¦å¿…è¦ãªæ™‚ã«ãã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ãã‚Œã‚‹ã€JavaScript APIã‹ã‚‰æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã®ä¿å­˜ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªç”¨é€”ãŒã‚ã‚Šã¾ã™ã€‚

- ã‚µã‚¤ãƒˆã®ç’°å¢ƒè¨­å®šã‚’å€‹äººã«åˆã‚ã›ã‚‹ã€‚
- ä»¥å‰ã®ã‚µã‚¤ãƒˆä¸Šã®è¡Œå‹•ã‚’å­˜ç¶šã•ã›ã‚‹ã€‚è¨˜æ†¶ã—ã¦ãŠãã€‚
- ã‚µã‚¤ãƒˆã‚’ã‚ˆã‚Šæ—©ããƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã¾ãŸã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šãªã—ã§ã‚µã‚¤ãƒˆã‚’åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
- ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒç”Ÿæˆã—ãŸæ–‡æ›¸ã‚’ã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§åˆ©ç”¨å¯èƒ½ã«ã™ã‚‹ã€‚

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ä¿å­˜ã¨ã‚µãƒ¼ãƒå´ã®ä¿å­˜ã¯ã€ã—ã°ã—ã°å…±ã«ä½¿ã„ã¾ã™ã€‚ãŸã¨ãˆã°ã€è¤‡æ•°ã®éŸ³æ¥½ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€ãã‚Œã‚‰ã®éŸ³æ¥½ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã«ä¿å­˜ã—ã€å¿…è¦ã«å¿œã˜ã¦å†ç”Ÿã™ã‚‹ãªã©ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚ŠéŸ³æ¥½ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¸€åº¦ã ã‘ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã ã‘ã§æ¸ˆã¿ã¾ã™ã€‚

> ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸APIã®ä¿å­˜ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿é‡ã«ã¯ä¸Šé™ãŒã‚ã‚Šã¾ã™ã€‚è©³ã—ãçŸ¥ã‚ŠãŸã„å ´åˆã¯ã€[ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸åˆ¶é™ã¨å‰Šé™¤åŸºæº–](https://developer.mozilla.org/ja/docs/Web/API/IndexedDB_API/Browser_storage_limits_and_eviction_criteria)ã‚’å‚ç…§ã€‚

### ã‚¯ãƒƒã‚­ãƒ¼ï¼šæ—§å¼

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã®ä¿å­˜ã«ã¯é•·ã„æ­´å²ãŒã‚ã‚Šã¾ã™ã€‚åˆæœŸã®é ƒã§ã¯cookieã‚’ä½¿ã£ã¦ãã¾ã—ãŸã€‚ã“ã‚Œã¯ã€ã‚¦ã‚§ãƒ–ä¸Šã§ä¸€èˆ¬çš„ã«ä½¿ã‚ã‚Œã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ä¿å­˜ã®ã€åˆæœŸã®å‹å¼ã§ã™ã€‚

æœ€è¿‘ã§ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹ç°¡å˜ãªä»•çµ„ã¿ãŒåˆ©ç”¨ã§ãã‚‹ãŸã‚ã€ã‚¯ãƒƒã‚­ãƒ¼ã¯ä½¿ã„ã¾ã›ã‚“ã€‚ãŸã ã—ã€ã‚¯ãƒƒã‚­ãƒ¼ã¯ç¾åœ¨ã§ã‚‚ã€ãƒ¦ãƒ¼ã‚¶ã®å€‹åˆ¥åŒ–ã€çŠ¶æ…‹ã«é–¢é€£ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ä¿æŒã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã€ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ãªã©ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚

### ã‚¦ã‚§ãƒ–ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã€IndexedDBï¼šæ–°å¼

[Web Storage API](https://developer.mozilla.org/ja/docs/Web/API/Web_Storage_API)ã¯ã€åå‰ã¨ãã‚Œã«å¯¾å¿œã™ã‚‹å€¤ã‹ã‚‰ãªã‚‹å°è¦æ¨¡ãªãƒ‡ãƒ¼ã‚¿é …ç›®ã‚’ä¿å­˜ã—ãŸã‚Šå–ã‚Šå‡ºã—ãŸã‚Šã€ã¨ã¦ã‚‚ç°¡æ½”ãªæ§‹æ–‡ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ¦ãƒ¼ã‚¶åã€ãƒ¦ãƒ¼ã‚¶ã®ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã€ç”»é¢ã®èƒŒæ™¯è‰²ãªã©ã€å˜ç´”ãªãƒ‡ãƒ¼ã‚¿ã‚’è¨˜æ†¶ã™ã‚‹ã ã‘ã®å ´åˆã«æœ‰ç”¨ã•ã‚Œã¾ã™ã€‚

[IndexedDB API](https://developer.mozilla.org/ja/docs/Web/API/IndexedDB_API)ã¯ã€è¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®å®Œå…¨ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«æä¾›ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€é¡§å®¢ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å®Œå…¨ãªé›†åˆã‹ã‚‰ã€éŸ³å£°ã€å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿å‹ã¾ã§ã€ç¨®ã€…ã®ã‚¿ã‚¹ã‚¯ã«å¯¾ã—ã¦ä½¿ãˆã¾ã™ã€‚

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥APIï¼šã“ã‚Œã‹ã‚‰

[Cache API](https://developer.mozilla.org/ja/docs/Web/API/Cache)ã¯ã€ç‰¹å®šã®è¦æ±‚ã«å¯¾ã™ã‚‹HTTPå¿œç­”ã‚’è¨˜æ†¶ã—ã¦ãŠããŸã‚ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãªã—ã§ã‚µã‚¤ãƒˆã‚’åˆ©ç”¨ã™ã‚‹ã¨ã„ã£ãŸã“ã¨ã§æœ‰ç”¨ã§ã™ã€‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯é€šå¸¸ã€[Service worker API](https://developer.mozilla.org/ja/docs/Web/API/Service_Worker_API)ã¨çµ„ã¿åˆã‚ã›ã¦åˆ©ç”¨ã—ã¾ã™ã€‚

### Web Storage APIï¼šå˜ç´”ãªãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹

ã‚¦ã‚§ãƒ–ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿ã¯ã€`sessionStorage, localStorage`ã®2ã¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹é€ ä½“ã®ä¸­ã«å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®2ã¤ã®é•ã„ã¯ã€`sessionStorage`ã®å ´åˆã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã‚‹ã¨ãƒ‡ãƒ¼ã‚¿ã‚’å¤±ã„ã¾ã™ãŒã€`localStorage`ã®å ´åˆã€ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã—ã¾ã™ã€‚

æ§‹æ–‡ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚

```javascript
// å€¤ã‚’è¨­å®š
localStorage.setItem('name', 'Chris');
// å€¤ã‚’å–å¾—
localStorage.getItem('name'); // 'Chris'
// å€¤ã‚’å‰Šé™¤
localStorage.removeItem('name');
```

### ãƒ‰ãƒ¡ã‚¤ãƒ³ã”ã¨ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸

å½“ç„¶ã§ã™ãŒã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³ã”ã¨ã®åˆ¥ã€…ã®ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã“ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã§ä¿å­˜ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ä»–ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã§ã¯åˆ©ç”¨ã§ããªã„ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

### å®Ÿè£…ã«è¿‘ã„ä¾‹ï¼šWeb Storage API

ã“ã®ä¾‹ã§ã¯ã€`name`å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã‚’ç”¨æ„ã—ã¦ã€ãã®å€¤ã‚’ä¿å­˜ã€è¡¨ç¤ºã™ã‚‹ã‚¢ãƒ—ãƒªã§ã™ã€‚

- MDN
  - [ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰](https://github.com/mdn/learning-area/tree/main/javascript/apis/client-side-storage/web-storage)
  - [ãƒ©ã‚¤ãƒ–](https://mdn.github.io/learning-area/javascript/apis/client-side-storage/web-storage/personal-greeting.html)
- ittoku-ky73
  - [ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰](https://github.com/ittoku-ky73/leaning-frontend/blob/main/js/Client-side_web_APIs/Personal-greeting)
  - [ãƒ©ã‚¤ãƒ–](https://ittoku-ky73.github.io/leaning-frontend/js/Client-side_web_APIs/Personal-greeting/)

### è¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿ä¿å­˜ï¼šIndexedDB API

ã“ã®ä¾‹ã§ã¯ã€ãƒ¡ãƒ¢å¸³ã‚¢ãƒ—ãƒªã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚ã“ã‚Œã¯ã€`title, text`å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã‚’ç”¨æ„ã—ã¦ã€ãã®å€¤ã‚’ä¿å­˜ã€è¡¨ç¤ºã™ã‚‹ã‚¢ãƒ—ãƒªã§ã™ã€‚å®Œæˆã™ã‚‹ã¨ã“ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼ˆç™¾èã¯ä¸€è¦‹ã«å¦‚ã‹ãšï¼‰ã€‚

- MDN
  - [ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰](https://github.com/mdn/learning-area/tree/main/javascript/apis/client-side-storage/indexeddb/notes)
  - [ãƒ©ã‚¤ãƒ–](https://mdn.github.io/learning-area/javascript/apis/client-side-storage/indexeddb/notes/)
- ittoku-ky73
  - [ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰](https://github.com/ittoku-ky73/leaning-frontend/blob/main/js/Client-side_web_APIs/Memo-app)
  - [ãƒ©ã‚¤ãƒ–](https://ittoku-ky73.github.io/leaning-frontend/js/Client-side_web_APIs/Web-storage/Memo-app)

### ã‚‚ã†1ã¤ã®è¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿ä¿å­˜ï¼šIndexedDB API

ã“ã®ä¾‹ã§ã¯ã€å‹•ç”»ã‚¹ãƒˆã‚¢ã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚ã“ã‚Œã¯å‹•ç”»ã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦IndexedDBãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã—ã€videoè¦ç´ ã§è¡¨ç¤ºã™ã‚‹ã‚¢ãƒ—ãƒªã§ã™ã€‚

- MDN
  - [ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰](https://github.com/mdn/learning-area/tree/main/javascript/apis/client-side-storage/indexeddb/video-store)
  - [ãƒ©ã‚¤ãƒ–](https://mdn.github.io/learning-area/javascript/apis/client-side-storage/indexeddb/video-store/)
- ittoku-ky73
  - [ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰](https://github.com/ittoku-ky73/leaning-frontend/blob/main/js/Client-side_web_APIs/Video-store)
  - [ãƒ©ã‚¤ãƒ–](https://ittoku-ky73.github.io/leaning-frontend/js/Client-side_web_APIs/Video-store)

### ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã®ä¿å­˜

ä¸Šè¨˜ã§ã¯ã€IndexedDBãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã«å¤§è¦æ¨¡ãªãƒªã‚½ãƒ¼ã‚¹ã‚’ä¿å­˜ã™ã‚‹ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¾ã—ãŸã€‚æ¬ ã‘ã¦ã„ã‚‹ã“ã¨ã¨ã„ãˆã°ã€HTML, CSS, JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€ã‚µã‚¤ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã³ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã“ã¨ã§ã™ã€‚ã“ã‚Œã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šãŒãªã„å ´åˆã€ã‚µã‚¤ãƒˆãŒå‹•ä½œã—ãªã„ã¨ã„ã†ã“ã¨ã§ã™ã€‚ã“ã“ã§ã€`Service worker, Cache API`ã®å‡ºç•ªã§ã™ã€‚

`Service worker`ã¯ã€ç‰¹å®šã®ã‚ªãƒªã‚¸ãƒ³ï¼ˆã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã€ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼‰ã«å¯¾ã—ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸæ™‚ã«ç™»éŒ²ã•ã‚Œã‚‹JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã®ã“ã¨ã§ã™ã€‚ç™»éŒ²ã•ã‚Œã¦ã„ã‚Œã°ã€ãã®ã‚ªãƒªã‚¸ãƒ³ã§åˆ©ç”¨å¯èƒ½ãªãƒšãƒ¼ã‚¸ã‚’åˆ¶å¾¡ã§ãã¾ã™ã€‚ã¾ãŸãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒšãƒ¼ã‚¸ã¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®é–“ã«ä½ç½®ã—ã¦ã€ã‚ªãƒªã‚¸ãƒ³å®›ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¦æ±‚ã‚’æ¨ªå–ã‚Šã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ã“ã†ã—ãŸåˆ¶å¾¡ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

è¦æ±‚ã®æ¨ªå–ã‚Šã¨ã¯ã€ä¾‹ã¨ã—ã¦ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å¿œç­”ã‚’ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã«ä¿å­˜ã—ã€ãã®è¦æ±‚ã«ãŒããŸå ´åˆã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å¿œç­”ã®ä»£ã‚ã‚Šã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ä¿å­˜ã—ã¦ã„ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å¿œç­”ã‚’ã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã‚’ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§æ©Ÿèƒ½ã•ã›ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚

`Cache API`ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ä¿å­˜ã®ä»•çµ„ã¿ã®1ã¤ã§ã™ã€‚ä»–ã®ä»•çµ„ã¿ã¨é•ã†ç‚¹ã¨ã—ã¦ã€HTTPå¿œç­”ã‚’ä¿å­˜ã™ã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã‚‹ç‚¹ã§ã™ã€‚ãã®ãŸã‚ã€`Service worker`ã¨å…±ã«ä½¿ã†ã¨ã€ã†ã¾ãæ©Ÿèƒ½ã—ã¾ã™ã€‚

### ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã®ä¾‹

å…ˆã»ã©ä½œã£ãŸãƒ“ãƒ‡ã‚ªã‚¹ãƒˆã‚¢ã‚’ã‚‚ã¨ã«ã€ã“ã‚Œã‚’ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚‚å‹•ä½œã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ãã¾ã™ã€‚

**ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã®ç™»éŒ²**

`script.js`ã«ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒä½¿ãˆã‚‹ã‹ã©ã†ã‹ã€ã¾ãŸã‚ªãƒªã‚¸ãƒ³ã‚’ç™»éŒ²ã—ã¦ã„ã¾ã™ã€‚ãã®ãŸã‚ã«æ¬¡ã®ã‚ˆã†ãªãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

- `Navigator`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§`ServiceWorker`ãƒ¡ãƒ³ãƒãƒ¼ãŒåˆ©ç”¨å¯èƒ½ã‹ã©ã†ã‹èª¿ã¹ã¦ã„ã¾ã™ã€‚
- [ServiceWorkerContainer.register()](https://developer.mozilla.org/ja/docs/Web/API/ServiceWorkerContainer/register)ã§ã€`ServiceWorker`ã«`sw.js`ã‚’ç™»éŒ²ã—ã¦ã„ã¾ã™ã€‚

```javascript
if ('serviceWorker' in navigator) {
  navigator.serviceWorker
    .register('/leaning-frontend/js/Client-side_web_APIs/Video-store-offline/sw.js')
    .then(() => console.log('Service Worker Registered'));
    .catch((err) => console.error('sw registration error: ' + err));
}
```

**ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**

`sw.js`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€`install`ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦ã€Service workerã‚’ä½¿ã†æº–å‚™ã‚’ã—ã¾ã™ã€‚ãã®ãŸã‚ã«æ¬¡ã®ã‚ˆã†ãªãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

- [ExtendableEvent.waitUntil()](https://developer.mozilla.org/ja/docs/Web/API/ExtendableEvent/waitUntil)ã‚’ä½¿ã£ã¦ã€å†…éƒ¨ã®ãƒ—ãƒ­ãƒŸã‚¹ãŒæˆåŠŸã—ã¦ã‹ã‚‰ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’å®Œäº†ã™ã‚‹ã¨çŸ¥ã‚‰ã›ã¦ã„ã¾ã™ã€‚
- [CacheStorage.open()](https://developer.mozilla.org/ja/docs/Web/API/CacheStorage/open)ã§ã€æ–°è¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ãã€[Cache.addAll()](https://developer.mozilla.org/ja/docs/Web/API/Cache/addAll)ã§ã€è¤‡æ•°ã®å¿œç­”ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚

```javascript
addEventListener('install', (e) => {
  e.waitUntil(
    caches.open('video-store')
      .then((cache) => {
        cache.addAll([
          'leaning-frontend/js/Client-side_web_APIs/Video-store-offline',
          'leaning-frontend/js/Client-side_web_APIs/Video-store-offline/index.html',
          'leaning-frontend/js/Client-side_web_APIs/Video-store-offline/style.css',
          'leaning-frontend/js/Client-side_web_APIs/Video-store-offline/script.js'
        ])
      })
      .catch((err) => console.log('sw install error: ' + err))
  );
});
```

**è¦æ±‚ã«å¿œç­”ã™ã‚‹**

ä¸Šè¨˜ã§æº–å‚™ãŒçµ‚ã‚ã‚Šã¾ã—ãŸã€‚ã¤ãã«ã€`fetch`ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã®ç™»éŒ²å…ˆã«å¯¾ã—ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«è¦æ±‚ã‚’å‡ºã•ã›ã¾ã™ã€‚ãã®ãŸã‚ã«æ¬¡ã®ã‚ˆã†ãªãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

- [FetchEvent.respondWith()](https://developer.mozilla.org/ja/docs/Web/API/FetchEvent/respondWith)ã¯ã€è¦æ±‚ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã®URLã‚’è¨˜éŒ²ã—ã¾ã™ã€‚
- [CacheStorage.match()](https://developer.mozilla.org/ja/docs/Web/API/CacheStorage/match)ã¯ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆURLï¼‰ã‚’æ¢ã—ã¾ã™ã€‚

```javascript
addEventListener('fetch', (e) => {
  e.respondWith(
    caches.match(e.request)
      .then((response) => response || fetch(e.request))
      .catch((err) => console.error('sw fetch error: ' + err))
  );
});
```

**ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§è©¦ã™**

chromeã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€developer tool -> Application -> Service Workers -> Offlineã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚

**å®Œæˆç‰ˆ**

- MDN

  - [ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰](https://github.com/mdn/learning-area/tree/main/javascript/apis/client-side-storage/cache-sw/video-store-offline)
  - [ãƒ©ã‚¤ãƒ–](https://mdn.github.io/learning-area/javascript/apis/client-side-storage/cache-sw/video-store-offline/)

- ittoku-ky73

    - [ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰](https://github.com/ittoku-ky73/leaning-frontend/blob/main/js/Client-side_web_APIs/Video-store-offline)

    - [ãƒ©ã‚¤ãƒ–](https://ittoku-ky73.github.io/leaning-frontend/js/Client-side_web_APIs/Web-storage/Video-store-offline)

### ã¾ã¨ã‚

æ¿€ãƒ ã‚ºAPIğŸ¤“ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å¸¯åŸŸå¹…ã‚’æ¸›ã‚‰ã™ã®ã‚’ç›®çš„ã¨ã—ãŸAPIã£ã¦æ„Ÿã˜ã€‚Cookieã¨ã‹ã¯ãƒ¦ãƒ¼ã‚¶èªè¨¼ã«ä½¿ãˆã‚‹ã—ã€WebStorageã¯ç°¡å˜ã ã—ã€IndexedDBã¯ãƒ–ãƒ©ã‚¦ã‚¶ã®ä¸­ã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã‚‹ã—ã€ServiceWorker, Cache APIã¯ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚µã‚¤ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚å…¨éƒ¨ä½¿ãˆã‚‹ğŸ¥¸
