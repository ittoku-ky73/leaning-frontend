# メディアクエリーの初心者向けガイド

> 参考：https://developer.mozilla.org/ja/docs/Learn/CSS/CSS_layout/Media_queries

このページでは、レスポンシブwebデザインの重要な部分であるCSSメディアクエリー（CSS Media Query）について見ていきます。

## メディアクエリの基本

```css
@media media-type and (media-feature-rule) {
  /* CSS rule */
}
```

上記は次のもので構成されます。

- `media-type`、コードがどのようなメディア（印刷、画面など）なのかブラウザに伝える。
- `media-feature-rule`、CSSを適用するための真偽を決めるテスト。
- `CSS rule`、media-feature-ruleでテストが通った場合に適用されるCSSのルール。

### メディア種別

指定できるメディアは次のとおりです。

- `all`、すべて。
- `print`、印刷。
- `screen`、画面。
- `speech`、音声合成。

下記のメディアクエリはページが印刷される場合にのみフォントを12ptに設定されます。

```css
@media print {
  body {
    font-size: 12pt;
  }
}
```

ここでのメディア種別は、[MIMEタイプ](https://developer.mozilla.org/ja/docs/Glossary/MIME_type)とは異なります。

レベル3のメディアクエリ仕様には他にも多くのメディア種別が定義されていますがこれらの多くは非推奨です。

メディア種別はオプションです。指定しなかった場合は`all`が適用されます。

### メディア特性の規則

次はメディア特性（media-feature）について見ていきます。

**幅と高さ**

これには、`min-width, max-width, width`のメディア特性を使用します。これらはレスポンシブデザインの作成に最も頻繁に検出される特性でビューポートの幅から適用を決めます。

```css
@media screen and (width: 600px) {
  body {
    color: red;
  }
}
```

下記はビューポートが600pxより狭い場合、青色になります。

```css
@media screen and (max-width: 600px) {
  body {
    color: blue;
  }
}
```

メディアクエリー仕様にはレベル4, 5がありますが、まだ新しいためブラウザサポートが不十分です。

**オリエンテーション**

メディア特性の1つに`orientation`があります。これはポートレートモード（`portrait`、縦長）やランドスケープモード（`landscape`、横長）をテストできます。

```css
@media (orientation: landscape) {
  body {
    color: green;
  }
}
```

デスクトップではランドスケープであり、携帯電話やタブレットはポートレートです。このテストでは、ポートレートモードのデバイス用に最適化されたレイアウトの作成に役立ちます。

**ポインティングデバイスの使用**

レベル4仕様の一部に、ホバー（hover）メディア特性が導入されました。この特性はユーザが要素の上にポインタを乗せることができるかテストします。つまりタッチスクリーンとキーバードナビゲーションはホバーしないということです。

```css
@media (hover: hover) {
  body {
    color: orange;
  }
}
```

他にもポインター（pointer）メディア特性もあります。これは、`none, fine, coarse`の3つの値があります。`fine`（細かい）はマウスやトラックパッド、`coarse`（粗い）はタッチスクリーン上の指、`none`（なし）はキーボードや音声などです。

### より複雑なメディアクエリ

メディアクエリは組み合わせたり、つなげたりしてすべてに一致するクエリなどを作成することもできます。

**メディアクエリのand**

メディア特性を組み合わせるには、`and`を使用します。

```css
@media screen and (min-width: 600px) and (orientation: landscape) {
  body {
    color: blue;
  }
}
```

**メディアクエリのor**

メディア特性を分けたい場合は、クエリをコンマ（`,`）で区切ることで実現できます。

```css
@media screen and (min-width: 600px), screen and (orientation: landscape) {
  body {
    color: blue;
  }
}
```

**メディアクエリのnot**

メディア特性を否定したい場合は、`not`演算子を使用します。これでメディアクエリの意味が逆になります。

```css
@media not all and (orientation: landscape) {
  body {
    color: blue;
  }
}
```

## ブレイクポイントの選択方法

レスポンシブデザインの初期には、多くのデザイナーが非常に具体的な画面サイズを対象にしようとしました。人気のある携帯電話やタブレットの画面サイズのリストは、それらのビューポートにきちんと一致するデザインを作成できるように公開されました。

しかし、現在は非常に多様なサイズのデバイスが多すぎて、それを実現できません。つまり、すべてのデザインにおいて特定のサイズを対象にするのではなく、コンテンツが壊れ始める（starts to break）サイズでデザインを変更する方が良いでしょう。このアプローチでメディアクエリが導入されるポイントを、ブレイクポイント（breakpoints）と呼びます。

## モバイルファーストレスポンシブデザイン（能動的学習）

レスポンシブデザインには2つのアプローチがあります。

- デスクトップ、または最も広いビューから始めて、ビューポートが小さくなるにつれて並べ替えるためのブレークポイントを追加する方法。
- 最小のビューから始めて、ビューポートが大きくなるにつれてレイアウトを追加する方法。

下の項目をモバイルファーストレスポンシブデザインと呼び、多くの場合このアプローチを選ぶべきです。

非常に小さなデバイスのビューは、通常フローで見られるようにコンテンツの単純な1列です。これは小さなデバイスには多くのレイアウトは必要ないことを意味します。ソースを適切な順序にすれば、デフォルトで読みやすいレイアウトになります。

### 単純なモバイルファーストのレイアウト（チュートリアル）

ここでは書かない。詳しくは[こちら](https://developer.mozilla.org/ja/docs/Learn/CSS/CSS_layout/Media_queries#walkthrough_a_simple_mobile-first_layout)で見ることができます。

## ビューポートメタタグ

これは、[レスポンシブデザイン#ビューポートメタタグ](https://github.com/ittoku-ky73/leaning-frontend/blob/main/css/CSS_layout/responsive_design.md#%E3%83%93%E3%83%A5%E3%83%BC%E3%83%9D%E3%83%BC%E3%83%88%E3%83%A1%E3%82%BF%E3%82%BF%E3%82%B0)の部分で書いています。そちらをご覧ください。

## メディアクエリは本当に必要か

フレックスボックス、グリッド、段組みのレイアウトはメディアクエリを使わずに柔軟でレスポンシブなコンポーネントを作成します。

しかし上記のレイアウトは、コンポーネントで使用可能な幅を見ていて、ビューポートの幅を見ていません。メディアクエリではビューポートの幅を見るので、画面上でのレイアウトに向いています。
